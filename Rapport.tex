\documentclass[11pt, a4paper]{article}

\usepackage[utf8]{inputenc} 	% L'encodage. Ca peut ÃƒÂªtre Ãƒ  remplacer par \usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\def\ques{\noindent{\bf Question : }}
\usepackage[english]{babel}
\usepackage[top=2cm, bottom=2cm, left=2cm, right=2cm]{geometry}		% Les marges
%\usepackage{listings}		% Pour mettre du code dans le fichier, il suffira ensuite d'appeler \begin{lstlisting}
%\lstset{
%language=Python,        	% choix du langage : C, Python, R, PHP...
%basicstyle=\footnotesize\color{mygray},       % taille de la police du code
%numbers=left,                   % placer les numéros de lignes Ãƒ  droite (right) ou Ãƒ  gauche (left)
%numberstyle=\footnotesize,        % taille de la police des numéros
%numbersep=7pt,                  % distance entre le code et sa numérotation
%stepnumber=1,
%tabsize=4
%}
\usepackage{lscape}
\usepackage{amsthm}
\newtheorem{theorem}{Theorem}
\setcounter{theorem}{0}
\usepackage{comment} 
\usepackage{float}
%\usepackage{capt-of}
\usepackage{graphicx}	% Si besoin de bosser sur des images. Si besoin, aller sur le SDZ.
\usepackage{color}
\definecolor{mygray}{rgb}{0.2,0.2,0.2}
\usepackage{xcolor}
\usepackage{multicol}
% Les packages pour mettre des expressions un peu mathématisées.
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathrsfs}
%\usepackage{mathtools}
%\usepackage{dsfont}
\newcommand{\horrule}[1]{\rule{\linewidth}{#1}}
\newcommand{\SR}[2]{\textcolor{gray}{#1}\textcolor{blue}{#2}}


\newtheorem{question}{Q}
\title{	
Composite likelihood inference of the parameters of a Poisson log-normale distribution
}

\date{\today}
\author{Elsa TEULIERE}

\graphicspath{ {./figures/} }
 

\begin{document}
\maketitle
\vspace{1cm}
\section*{Introduction}
\section{Poisson log-normal model}
The Poisson log normal model was developped by Aitchison \textit{et al.}\cite{aitchison1989multivariate}, to modell multivariate count data.  The idea is to introduce latent gaussian variables encoding the dependency between the variables. In this section we introduce this model and our notation and briefly review the existing litterature on this model.
\subsection{Definitions and notations}
We note $\mathcal{N}(p,Q)$ the multivariate normale distribution of mean $p$ and variance-covariance $Q$, and $\mathcal{P}(\alpha)$ the Poisson-distribution of mean $\alpha$.
\subsubsection{The Model} 
We consider $(\mu,\Sigma) \in \mathbb{R}^n \times \mathcal{M}_n(\mathbb{R})$, with $\Sigma$ a symetric non negative matrix, the parameters of the model.\\
We consider the latent variables $Z \sim \mathcal{N}(0,\Sigma)$.\\
Multivariate count data $(Y_1,...,Y_n)$ follow a Poisson log-normal model of mean $\mu$ and matrix of variance-covariance $\Sigma$ if :
\begin{center}
$\forall i \in \{1,...n\}, Y_i \mid Z_i \sim \mathcal{P}(e^{\mu_i+Z_j})$
\end{center}
and 
\begin{center}
$\forall (i,j) \in \{1,...,n\}^2$, $ Y_i\mid Z_i$ and $Y_j\mid Z_j$ independant.
\end{center}

We typically consider $N$ independant sampling experiment of $n$ variables each time, for example the case of sampling $n$ species over $N$ sites. In our notations, the exposant allways stands for the sampling experiment, and the underscore stand for the observed variable.\\
So we now have $(Z^j)_{j \in \mathbb{N}}$ latent variables, independant and identically distributed : $\forall j \in \{1,...,N}$, $Z^j \sim \mathcal{N}(0,\Sigma)$, and :
\begin{center}
$\forall (i,j) \in \{1,...,n\} \times \{1,...,N\}$, $Y^j_i \mid Z^j_i \sim \mathcal{P}(e^{\mu_i+Z^j_i})$.
\end{center}
The advantage of this model is that all the dependance structure is encoded through gaussian variables.
\subsubsection{Extension accounting for covariates and offset}
In multivariate data, the dependency can occur through covariates. As developped in \cite{chiquet2017variational}, we will postulate the existence of a linear regression in  the parameters space. \\
\\
In this case, we consider a vector $X^j \in \mathbb{R}^d$ of covariates (collected for each sampling). Let $M$ be a $d \times n$ Matrix, called the matrix of regression parameters. We note $\mu^i$ the $i^{th}$ column of the matrix M. We can also add one offset parameter per observation $O^j_i$. The offset, can typically be the sampling effort. In this case the Poisson log-normal model is given by :
\begin{center}
$\forall (i,j) \in \{1,...,n\} \times \{1,...,N\}$, $Y^j_i \mid Z^j_i \sim \mathcal{P}(e^{O^j_i + X_j^T \mu^i +Z^j_i})$ 
\end{center}
The set of parameters, that we aim to estimate is now given by $(M,\Sigma) \in \mathcal{M}_{d \times n}(\mathbb{R}) \times \mathcal{M}_{n}(\mathbb{R})$.\\
\\
This model enable us to take in account for fixed additional effects. Indeed, it can help to interpret the dependency parameters. For examples, 	Poisson log-normal model can be used to estimate an interaction network from the co-occurancy. With this model, we can hope, with a good choice of the covariables, that the dependencies encoded in the variance-covariance matrix $\Sigma$ will indicate the interraction between species.
\subsection{Properties}
\subsubsection{Density function and moments}
\textit{AiH89-Biometrika}
\subsubsection{Overdispersion}
\subsection{Variational estimation of the parameters}
\textit{\`a travailler PLN/PCA}
\SR{}{Pour ce passage, il faut faire court en rappelant le principe de VEM et en disant qu'on sait le faire pour PLN.}
\section{Composite likelihood estimation}
\subsection{Definition and notation}
\subsubsection{Presentation of the composite likelihood}
\textit{VRF11-StatSinica}
\subsubsection{Composite likelihood for the PLN model}
\textit{Expression, definition of the $\Sigma_{ij},\mu_{ij}$, \'equivalence des couples}
\subsection{Consistency}
\subsubsection{M-estimator theory}
\textit{chap.5 Assymptotic Statistics van der Vaart}
\subsubsection{Consistency of the composite likelihood for the PLN model}
\textit{proof}
\subsection{Assymptotic normality}
\subsubsection{M-estimator theory}
\textit{chap.5 Assymptotic Statistics van der Vaart}
\subsubsection{Assymptotic normality of the composite likelihood for the PLN model}
\textit{proof}
\subsubsection{Construction of assymptotic statistic tests (?)}
\textit{Peut-etre trop scolaire...} \SR{}{Je suis d'accord. Il suffit de dire que la normalite asymptotique nous donne les intervalles de confiance (asymptotiques) et les tests (asymptotiques)}

\section{Composite likelihood inference for spatial data}
\subsection{Poisson log-normal model for spatial data}
\subsubsection{One specie\SR{}{s} \SR{(meme au singulier)}{}, spatial dependency}
\subsubsection{spatial parametrisation of the PLN}
\subsection{Computational optimisation by taking a sparce CL}

\section{Illustrations}
\subsection{Simulations}
\subsection{'Tiques' data}

\appendix
\section{Appendix}
\subsection{Gradients}
\subsection{Hessian}
\subsection{Spatial gradient and hessian}


\end{document}